<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.5.18 (466205)"/><meta name="author" content="TONY GAO"/><meta name="created" content="2022-02-26 00:56:38 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2022-05-06 06:55:31 +0000"/><title>Apache Spark Configuration</title></head><body><hr/><div><font style="font-size: 18px;" color="#0433ff"><span style="font-size: 18px; background-color: rgb(255, 250, 165); color: rgb(4, 51, 255); font-style: italic; text-decoration: underline;-evernote-highlight:true;">PySpark environment configuration</span></font></div><div><font color="#0433ff" style="font-size: 18px;"><br/></font></div><div><span style="font-size: 16px; color: rgb(36, 41, 47);">pipenv - </span><span style="font-size: medium; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(18, 18, 18); font-family: -apple-system, system-ui, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">Pipenv是官方推荐的的python包管理工具，可以实现项目之间依赖的隔离</span></div><div><span style="font-size: 16px;"><a href="https://pipenv.pypa.io/en/latest/" style="font-size: 16px;">https://pipenv.pypa.io/en/latest/</a></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Python kernel for Jupyter</span></span></div><ol><li><div><span style="font-size: 16px; color: rgb(36, 41, 47);">pipenv install - install from </span><span style="caret-color: rgb(36, 41, 47); font-size: 16px; color: rgb(36, 41, 47);">piffle, if there is one</span></div></li><li><div><span style="font-size: 16px; color: rgb(36, 41, 47);">pipenv shell - to activate the pipenv shell under a project folder(env)</span></div></li><li><div><span style="font-size: 16px; color: rgb(36, 41, 47);">pipenv install &lt;package&gt; - instead of pip install</span></div></li><li><div><span style="caret-color: rgb(36, 41, 47); font-size: 16px; color: rgb(36, 41, 47);">pipenv update or pipenv update &lt;package&gt;</span></div></li><li><div><span style="caret-color: rgb(36, 41, 47); font-size: 16px; color: rgb(36, 41, 47);">pipenv graph or pip list - to list the installed packages </span></div></li><li><div><span style="font-size: 16px; color: rgb(36, 41, 47);">relevant packages and tools were installed in directory </span>
<span style="font-size: 12px; background-color: rgb(190, 234, 238); color: rgb(0, 0, 0); font-family: Monaco; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures; font-weight: normal; line-height: normal;">/Users/tonygao/.local/share/virtualenvs</span></div></li><li><div>
<span style="font-size: 12px; background-color: rgb(190, 234, 238); color: rgb(0, 0, 0); font-family: Monaco; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures; font-weight: normal; line-height: normal;">pipenv --python /Users/tonygao/.pyenv/versions/3.9.10/bin/python3.9 shell</span><span style="font-family: Monaco;"> to activate the pipenv shell and create a python virtual environment with specific python version managed by pyenv. </span></div></li></ol><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px;"><span style="font-size: 16px; color: rgb(255, 38, 0);">Suggest to </span><span style="font-size: 16px; color: rgb(255, 38, 0); font-weight: bold;">brew install pyenv </span><span style="font-size: 16px; color: rgb(255, 38, 0);">altogether to manage the python version we want.</span></span></div><div><span style="font-size: 16px;"><span style="font-size: 16px;"><br/></span></span></div><div><span style="font-size: 16px;"><span style="font-size: 16px; color: rgb(36, 41, 47); font-weight: bold;">Pipenv install pyspark</span></span></div><ol><li><div><span style="caret-color: rgb(36, 41, 47); font-size: 16px; color: rgb(36, 41, 47);">Pyspark -&gt; python</span></div></li><li><div><span style="caret-color: rgb(36, 41, 47); font-size: 16px; color: rgb(36, 41, 47);">Spark-shell -&gt;scala </span></div></li><li><div><span style="font-size: 16px; color: rgb(36, 41, 47);">Spark-subimit —version -&gt;check spark and scala version </span></div></li></ol><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">Scala kernel for Jupyter</span></span></div><div><span style="font-size: 16px;"><a href="https://github.com/almond-sh/almond" style="font-size: 16px;">https://github.com/almond-sh/almond</a></span></div><div><a href="https://almond.sh/docs/quick-start-install">https://almond.sh/docs/quick-start-install</a></div><div><a href="https://cloud.tencent.com/developer/article/1740274">https://cloud.tencent.com/developer/article/1740274</a></div><ol><li><div>Install the Jupyter notebook by using pipenv prior to install the Jupyter-scala</div></li><li><div>Install<span style="color: unset; font-family: unset;"> the jupyter-scala - </span><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(119, 119, 119); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">git clone </span><a href="https://github.com/jupyter-scala/jupyter-scala.git" style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(119, 119, 119); font-family: &quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">https://github.com/jupyter-scala/jupyter-scala.git</a></div></li><li><div>Making sure have JVM installed</div></li><li><div><span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">$ curl -Lo coursier </span><a href="https://git.io/coursier-cli" style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">https://git.io/coursier-cli</a><span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;" /></div></li><li><div><span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">$ chmod +x coursier </span></div></li><li><div><span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">$ ./coursier launch --fork almond:0.10.0 --scala 2.12 -- --install</span></div></li><li><div><span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">$ rm -f coursier</span></div></li><li><div><span style="color: unset; font-family: unset;">Be careful about the Scala version to install</span></div></li><li><div>Check - <span style="font-size: 13.6px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(240, 240, 240); color: rgb(68, 68, 68); font-family: SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal;">$ jupyter hernelspec list</span></div></li></ol><div><br/></div><div><span style="font-weight: bold;">Scala + Spark kernel for Jupyter</span></div><div><a href="https://github.com/vericast/spylon-kernel">https://github.com/vericast/spylon-kernel</a></div><ol><li><div>Install </div></li></ol><div style="background-color: var(--color-canvas-subtle); font-size: 13.6px; letter-spacing: normal; orphans: 2; widows: 2; word-spacing: 0px;"><span style="font-size: 13.6px; color: rgb(36, 41, 47); font-family: ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45;">$ pip install spylon-kernel</span></div><ol start="2"><li><div style="background-color: var(--color-canvas-subtle); font-size: 13.6px; letter-spacing: normal; orphans: 2; widows: 2; word-spacing: 0px;"><span style="font-size: 13.6px; color: rgb(36, 41, 47); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45;">Using it as a Scala kernel to work with Spark in Scala with Python</span></div></li></ol><div style="background-color: var(--color-canvas-subtle); font-size: 13.6px; letter-spacing: normal; orphans: 2; widows: 2; word-spacing: 0px;"><span style="box-sizing: border-box; font-size: 13.6px; overflow-wrap: normal; overflow: auto; background-color: var(--color-canvas-subtle); border-top-left-radius: 6px; border-top-right-radius: 6px; border-bottom-right-radius: 6px; border-bottom-left-radius: 6px; word-break: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(36, 41, 47); font-family: ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45;">$ python -m spylon_kernel install</span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Installations_Mac_Ubuntu_Windows</span></div><div><a href="https://github.com/mGalarnyk/Installations_Mac_Ubuntu_Windows">https://github.com/mGalarnyk/Installations_Mac_Ubuntu_Windows</a></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">Run spark with Jupiter notebook in Docker</span></div><div><a href="https://hub.docker.com/r/jupyter/all-spark-notebook">https://hub.docker.com/r/jupyter/all-spark-notebook</a></div><div><br/></div><hr/><div><span style="font-size: 18px;"><span style="font-size: 18px;background-color: rgb(255, 250, 165);-evernote-highlight:true;"><br/></span></span></div><div><span style="font-size: 18px;"><span style="font-size: 18px; background-color: rgb(255, 250, 165); color: rgb(4, 51, 255); font-style: italic; text-decoration: underline;-evernote-highlight:true;">Hadoop + Hive + Yawn + Spark clusters configuration (Ubuntu OS VM) with JDK, Scala, SBT installation.</span></span></div><div><span style="font-size: 18px;"><br/></span></div><div><a href="https://www.udemy.com/course/apache-spark-in-depth-spark-with-scala/learn/lecture/26420220#questions" style="font-size: 13px;">https://www.udemy.com/course/apache-spark-in-depth-spark-with-scala/learn/lecture/26420220#questions</a></div><div><span style="font-size: 18px;"><a href="Apache%20Spark%20Configuration.resources/Installation+Steps.txt">Installation+Steps.txt</a></span></div><div><span style="font-size: 18px;"><a href="Apache%20Spark%20Configuration.resources/Start+Spark.txt">Start+Spark.txt</a></span></div><ol><li><div><span style="caret-color: rgb(4, 51, 255); font-size: 18px;">Install</span><span style="font-size: 18px;"> Ubuntu OS VM on virtualBox</span></div></li><li><div><span style="caret-color: rgb(4, 51, 255); font-size: 18px;">Download</span><span style="font-size: 18px;"> JDK, e.g., version 1.8 - </span><span style="font-size: 18px;">jdk1.8.0_321 from Oracle </span><span style="caret-color: rgb(4, 51, 255); font-size: 18px;">website</span></div></li><li><div><span style="font-size: 18px;">Move the </span><span style="font-size: 18px;">jdk1.8.0_321 folder to the path <span style="font-size: 18px; color: rgb(4, 51, 255);">/user/local/java</span></span></div></li><li><div><span style="caret-color: rgb(4, 51, 255); font-size: 18px;">Add the JDK path to environment variable by write the statement in the .bashrc file (</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">可以vi .bash_profile看到文件里内容,加载执行.bashrc文件,声明</span><a href="https://so.csdn.net/so/search?q=%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F&amp;spm=1001.2101.3001.7020" style="box-sizing: border-box; outline: none; cursor: pointer; background-image: url(&quot;file:///Applications/%E5%8D%B0%E8%B1%A1%E7%AC%94%E8%AE%B0.app/Contents/Resources/img/iconHighlight.svg&quot;); background-size: 12px 14px; background-color: rgb(255, 255, 255); overflow-wrap: break-word; border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: none; font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(252, 85, 49); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures; background-position: right top; background-repeat: no-repeat no-repeat;">环境变量</a><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">等等,用户内登陆的时候会自动加载,所以一些个人环境变量的更改,命令的别名容等等设置,可以自定义设置在这里.)</span></div></li></ol><div><span style="font-size: 18px;"><img src="Apache%20Spark%20Configuration.resources/4DC8885F-BDA0-400A-9B8C-F968539C8FC5.png" height="748" width="893"/><br/></span></div><ol start="5"><li><div><span style="color: rgb(4, 51, 255);">Source ~/.bashrc  （</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">source（或点）命令通常用于重新执行刚修改的初始化文档，如 .bash_profile 和 .profile 等等。</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">假如在登录后对 .bash_profile 中的 EDITER 和 TERM 变量做了修改，则能够用source命令重新执行 .bash_profile 中的命令而不用注销并重新登录）</span></div></li></ol><div><img src="Apache%20Spark%20Configuration.resources/B3F0F913-A6C1-4114-B084-CF477F048F91.png" height="484" width="741"/><br/></div><ol start="6"><li><div><span style="font-size: 18px;">Java was found</span></div></li><li><div><span style="font-size: 16px; orphans: 2; widows: 2;"><span style="font-size: 16px; color: rgb(4, 51, 255); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-ligatures: normal;">Update-alternatives --install “”</span></span><span style="font-size: 16px; orphans: 2; widows: 2; color: rgb(64, 64, 64); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-ligatures: normal;"> (update-alternatives 命令用于处理 Linux 系统中软件版本的切换，使其多版本共存。alternatives 的管理目录 </span><span style="font-size: 12px; border: none; vertical-align: middle; white-space: pre-wrap; background-color: rgb(242, 242, 242); orphans: 2; widows: 2; color: rgb(199, 37, 78); font-family: Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace; font-variant-ligatures: normal;">/etc/alternatives</span><span style="font-size: 16px; orphans: 2; widows: 2; color: rgb(64, 64, 64); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-ligatures: normal;"> </span><span style="font-size: 16px;"><a href="https://www.jianshu.com/p/4d27fa2dce86" style="font-size: 16px;">https://www.jianshu.com/p/4d27fa2dce86</a></span><span style="font-size: 16px; orphans: 2; widows: 2; color: rgb(64, 64, 64); font-family: -apple-system, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;, &quot;Segoe UI&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-variant-ligatures: normal;">)</span></div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>sudo update-alternatives --install "/usr/bin/java" "java" "/usr/local/java/jdk1.8.0_261/bin/java" 1</div><div>sudo update-alternatives --install "/usr/bin/javac" "javac" "/usr/local/java/jdk1.8.0_261/bin/javac" 1</div><div>sudo update-alternatives --install "/usr/bin/javaws" "javaws" "/usr/local/java/jdk1.8.0_261/bin/javaws" 1</div></div><div><img src="Apache%20Spark%20Configuration.resources/6C419330-D5FE-42BD-BEDC-5175F05FA519.png" height="483" width="1219"/><br/></div><div>Java这个可执行命令<span style="color: rgb(4, 51, 255);">/usr/bin/java</span>实际是一个链接，指向了 <span style="color: rgb(4, 51, 255);">/etc/alternatives/java</span> 。而这个也是一个链接，指向了<span style="color: rgb(4, 51, 255);"> /usr/local/java/jdk1.8.0_321/bin/java</span><span style="font-size: unset; color: unset; font-family: unset;">，这才是最终的可执行文件。alternatives 实际上是通过软链接的方式对版本进行管理。</span></div><div><span style="font-size: unset;"><br/></span></div><div><span style="font-size: unset; color: unset; font-family: unset;">I<span style="background-color: rgb(255, 250, 165); font-size: unset; color: unset; font-family: unset;-evernote-highlight:true;">n this way, it allows other applications which uses the </span></span><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="font-size: unset;"><span style="font-size: unset; background-color: rgb(255, 250, 165); color: rgb(4, 51, 255); font-family: unset;-evernote-highlight:true;">/usr/bin/java</span></span><span style="font-size: unset; background-color: rgb(255, 250, 165); color: unset; font-family: unset;-evernote-highlight:true;"> can find the executable java pointing to </span><span style="background-color: rgb(255, 250, 165); color: rgb(4, 51, 255);-evernote-highlight:true;">/usr/local/java/jdk1.8.0_321/bin/java</span></span></div><div><br/></div><ol start="8"><li><div>Set up ssh keys for connections between multiple data nodes and namenode in situation of <span style="font-weight: bold;">Pseudo-distributed Hadoop Single Node</span> Cluster (one namenode + datanodes on localhost machine)</div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>https://www.ruanyifeng.com/blog/2011/12/ssh_remote_login.html</div><div>https://www.jianshu.com/p/3cc896dc407c</div><div>Synopsis: ssh-keygen [-q] [-b bits] [-t dsa | ecdsa | ed25519 | rsa] [-N new_passphrase] [-C comment] [-f output_keyfile]</div><div><br/></div><div><br/></div><div>- sudo apt-get update</div><div>- sudo apt-get upgrade</div><div>- sudo apt-get install openssh-server</div><div><div><br/></div><div><br/></div></div><div>- ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa</div><div>- cat ~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</div><div><div><br/></div><div><br/></div></div><div>- ssh localhost          (or "<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">ssh -o StrictHostKeyChecking=no localhost” if fingerprint checking is asked for.</span>)</div></div><div><br/></div><ol start="9"><li><div>Download Hadoop <a href="https://hadoop.apache.org/release/2.8.5.html">https://hadoop.apache.org/release/2.8.5.html</a> tar.gz file</div></li></ol><div><br/></div><ol start="10"><li><div>Untar and move to directory "usr/local/hadoop" with shell command: </div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>tar -xzvf hadoop-2.8.5.tar.gz -C /usr/local/hadoop</div></div><div><br/></div><ol start="11"><li><div>set up the path. Open command line and wrote "gedit ~/.bashrc” and copy the below to .bashrc file</div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>export HADOOP_HOME=/usr/local/hadoop/hadoop-2.8.5</div><div>export PATH=$PATH:$HADOOP_HOME/bin</div><div>export PATH=$PATH:$HADOOP_HOME/sbin</div><div>export HADOOP_CONF_DIR=/usr/local/hadoop/hadoop-2.8.5/etc/hadoop</div></div><div>         source ~/.bashrc</div><div><br/></div><div>   12. Do some changes in conf files as explained in video <a href="https://www.udemy.com/course/apache-spark-in-depth-spark-with-scala/learn/lecture/26420220#questions">https://www.udemy.com/course/apache-spark-in-depth-spark-with-scala/learn/lecture/26420220#questions</a> start from 1 h 06 min</div><ul><ul><li><div>  <span style="font-weight: bold;">  </span><span style="color: rgb(148, 55, 255); font-weight: bold;">/usr/local/hadoop/hadoop-2.8.5/etc/hadoop/core-site.xml </span></div></li></ul></ul><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;configuration&gt;</div><div>&lt;property&gt;</div><div>&lt;name&gt;fs.default.name&lt;/name&gt;</div><div>&lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</div><div>&lt;/property&gt;</div><div>&lt;property&gt;</div><div>&lt;name&gt;hadoop.temp.dir&lt;/name&gt;</div><div>&lt;value&gt;/usr/local/hadoop/hadoop-2.8.5/etc/hadoop/hadooptmp&lt;/value&gt;</div><div>&lt;/property&gt;</div><div>&lt;/configuration&gt;</div></div><ul><ul><li><div><span style="color: rgb(148, 55, 255); font-weight: bold;"> /usr/local/hadoop/hadoop-2.8.5/etc/hadoop/hadoop-env.sh</span></div></li></ul></ul><div>Specify the JAVA_HOME path</div><div><img src="Apache%20Spark%20Configuration.resources/E53EBB91-5827-4DE3-B013-7B1B02610986.png" height="48" width="489"/><br/></div><ul><ul><li><div><span style="color: rgb(148, 55, 255); font-weight: bold;">/usr/local/hadoop/hadoop-2.8.5/etc/hadoop/mapred-site.xml.template —&gt; rename it to “mapred-site.xml"</span></div></li></ul></ul><div>Specify the resource manager </div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;configuration&gt;</div><div>&lt;property&gt;</div><div>      &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</div><div>      &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">yarn</span>&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>&lt;/configuration&gt;</div></div><ul><ul><li><div><span style="color: rgb(148, 55, 255); font-weight: bold;">/usr/local/hadoop/hadoop-2.8.5/etc/hadoop/yarn-site.xml</span></div></li></ul></ul><div>Specify the configures of yarn</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>&lt;configuration&gt;</div><div>   &lt;property&gt;</div><div>        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</div><div>        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>   &lt;property&gt;</div><div>        &lt;name&gt;yarn.nodemanager.aux-services.mapreduce.shuffle.class&lt;/name&gt;</div><div>        &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>&lt;/configuration&gt;</div></div><div><br/></div><ul><ul><li><div><span style="color: rgb(148, 55, 255); font-weight: bold;">/usr/local/hadoop/hadoop-2.8.5/etc/hadoop/hdfs-site.xml</span></div></li></ul></ul><div>指定namenode and datanode存储位置， <span style="color: rgb(255, 38, 0);">默认位置在参考</span><span style="font-size: 16px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 38, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: no-common-ligatures;">core-site.xml</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><div><br/></div><div><br/></div></div><div>&lt;configuration&gt;</div><div>   &lt;property&gt;</div><div>      &lt;name&gt;dfs.replication&lt;/name&gt;</div><div>      &lt;value&gt;1&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>   </div><div>   &lt;property&gt;</div><div>      &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</div><div>      &lt;value&gt;file:/usr/local/hadoop/hadoop-2.8.5/tmp/dfs/name&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>   </div><div>   &lt;property&gt;</div><div>      &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</div><div>      &lt;value&gt;file:/usr/local/hadoop/hadoop-2.8.5/tmp/dfs/data&lt;/value&gt;</div><div>   &lt;/property&gt;</div><div>&lt;/configuration&gt;</div></div><div><br/></div><ol start="13"><li><div> Start hdfs and yarn</div></li></ol><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>start-dfs.sh</div><div>start-yarn.sh</div></div><div><br/></div><div><br/></div><div>    14. Install Hive (hive uses the Derby as metadata database, but Derby cannot be queried simultaneously for multiple users, thus here change to mySQL database)</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>- sudo apt-get update</div><div>- sudo apt-get upgrade</div><div>- sudo apt-get install mysql-server</div><div>- sudo mysql_secure_installation</div><div>- sudo "mysql -u root -p “ </div><div><br/></div><div>Refer to https://www.sqlshack.com/how-to-install-mysql-on-ubuntu-18-04/ (follow these steps and set root use password as mysql123456)</div></div><div><br/></div><ol start="15"><li><div>Change mysql authentication plugin from “caching_sha2_password” to “mysql_native_password”, create user, password, set privileges and create database for hive metastore.</div></li></ol><div><a href="https://www.sqlshack.com/how-to-install-mysql-on-ubuntu-18-04/">https://www.sqlshack.com/how-to-install-mysql-on-ubuntu-18-04/</a></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>- CREATE USER 'hiveuser'@'%' IDENTIFIED BY 'Hive@123456';</div><div>- GRANT ALL PRIVILEGES ON *.* TO 'hiveuser'@'%' WITH GRANT OPTION;</div><div>- ALTER USER ‘hiveuser’@'%' IDENTIFIED WITH mysql_native_password BY ‘Hive@123456';</div><div>- FLUSH PRIVILEGES;</div><div>- CREATE DATABASE metastore_db;</div></div><div>    </div><ol start="16"><li><div>Rename the file <span style="font-weight: bold;">hive-default.xml.template </span>(directory $HIVE_HOME/conf) to <span style="font-weight: bold;">hive-site.xml</span>. Then, modify the configurations of <span style="font-weight: bold;">hive-site.xml </span>file accordingly. </div></li></ol><div><a href="https://data-flair.training/blogs/configure-hive-metastore-to-mysql/">https://data-flair.training/blogs/configure-hive-metastore-to-mysql/</a> </div><div><a href="https://stackoverflow.com/questions/50500718/underlying-cause-java-lang-classnotfoundexception-com-mysql-jdbc-driver-use">https://stackoverflow.com/questions/50500718/underlying-cause-java-lang-classnotfoundexception-com-mysql-jdbc-driver-use</a></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><b>Hive连元数据有两种方式连接</b></div><div><b>第一种是直连，就是直接去mysql的metastore库里去连接。</b></div><div><b>另一种通过服务去连接，hive有个服务叫metastore，还有一个服务叫hiveserver2。hive去启动metastore服务，然后服务去连接mysql，找到元数据。</b></div><div>&lt;property&gt; </div><div>    &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt; <font color="#ff2600">直接去mysql的metastore库里去连接</font></div><div>    &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">jdbc:mysql://localhost/metastore_db?createDatabaseIfNotExist=true</span>&lt;/value&gt;</div><div>&lt;/property&gt;</div><div>&lt;property&gt;</div><div>    &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;</div><div>    &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">hiveuser</span>&lt;/value&gt;</div><div>&lt;/property&gt;</div><div>&lt;property&gt;</div><div>    &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;</div><div>    &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">Hive@123456</span>&lt;/value&gt;</div><div>&lt;/property&gt;</div><div>&lt;property&gt;</div><div>    &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;</div><div>    &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">com.mysql.jdbc.Driver</span>&lt;/value&gt; <font color="#ff2600">(change to com.mysql.cj.jdbc.Driver for mysql version 8 above)</font></div><div>&lt;/property&gt;[/php]</div><div><br/></div><div><font face="Monaco" color="#ff2600" style="">如果需要使用hive metastore service连接metastore的话</font></div><div>&lt;property&gt;</div><div>     &lt;name&gt;hive.metastore.uris&lt;/name&gt;</div><div>     &lt;value&gt;<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">thrift://localhost:9083</span>&lt;/value&gt;</div><div>     &lt;description&gt;Thrift server hostname and port&lt;/description&gt;</div><div>&lt;/property&gt;</div></div><div><br/></div><div>     17.  <span style="font-size: 15px; color: rgb(35, 38, 41); font-family: unset;">Download the mysql JDBC Connector to access the MySQL database from Metastore Service. And, p</span><span style="font-size: 15px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(35, 38, 41); font-family: -apple-system, system-ui, &quot;Segoe UI Adjusted&quot;, &quot;Segoe UI&quot;, &quot;Liberation Sans&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">lace the connector jar to $HIVE_HOME/lib directory to make it available in class-path.</span></div><div><br/></div><div><a href="https://mvnrepository.com/artifact/mysql/mysql-connector-java/8.0.28">https://mvnrepository.com/artifact/mysql/mysql-connector-java/8.0.28</a></div><div><br/></div><div>Here, download the MySQL Connector 8.0.28 from Maven Repository and put under the<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"> /usr/local/hive/hive-2.3.6/lib. ($HIVE_HOME/lib)</span></div><div><br/></div><div>    18.  Change hive metastore database from Derby to MySQL ( by running the below command: </div><div>Initialise metastore schema to hive 2.3</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">$HIVE_HOME/bin/schematool -initSchema -dbType mysql</span></div></div><div><br/></div><div>    19.  Start Hive </div><div><a href="https://blog.csdn.net/weixin_42796403/article/details/112757133">https://blog.csdn.net/weixin_42796403/article/details/112757133</a> (hive-cli, hiveserver2, hive metastoreserice 启动)</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nohup hive --service metastore</div></div><div><br/></div><div><br/></div><div>     20. <span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 14px; color: rgb(77, 77, 77); font-family: Arial; font-variant-caps: normal; font-variant-ligatures: normal;">首次启动hadoop需要先在 Master 节点执行 NameNode 的格式化</span></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>hdfs namenode -format # 首次运行需要执行初始化，之后不需要</div></div><div><br/></div><div>    然后就可以运行 hive</div><div><br/></div><ol start="21"><li><div>Install scala and set environment variables</div></li></ol><div><span style="font-size: unset;"><br/></span></div><ol start="22"><li><div><span style="font-size: unset; color: unset; font-family: unset;">Install Spark and set environment variable</span></div></li></ol><div><a href="https://archive.apache.org/dist/spark/"> https://archive.apache.org/dist/spark/</a></div><ol start="21"><ul><li><div>If Hadoop is not installed, we can install “Pre-built for Apache Hadoop”/"spark-bin-hadoop"</div></li><li><div>If Hadoop is installed, we can install “Pre-built with user-provided Apache Hadoop”/ "spark-bin-without-hadoop"</div></li></ul></ol><div><span style="font-weight: bold;">Spark has different running mode (</span><span style="font-weight: bold; color: rgb(255, 38, 0);">Local模式（单机模式）、Standalone模式（使用Spark自带的简单集群管理器）、YARN模式（使用YARN作为集群管理器）和Mesos模式（使用Mesos作为集群管理器）</span><span style="font-weight: bold;">)</span><span style="font-weight: bold;">, thus the corresponding configuration will be different, as following:</span></div><ul><ul><li><div><a href="https://www.jianshu.com/p/65a3476757a5" style="font-weight: bold;">https://www.jianshu.com/p/65a3476757a5</a>                </div></li></ul></ul><div><br/></div><ul><ul><li><div><a href="http://dblab.xmu.edu.cn/blog/1689-2/" style="font-weight: bold;">http://dblab.xmu.edu.cn/blog/1689-2/</a></div></li></ul></ul><div><span style="font-weight: bold;">Deploying local mode after install spark,</span><span style="font-weight: bold;">需要修改Spark的配置文件spark-env.sh</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>cd /usr/local/spark</div><div>cp ./conf/spark-env.sh.template ./conf/spark-env.sh</div></div><div><span style="font-weight: bold;"><br/></span></div><div><span style="font-weight: bold;">编辑spark-env.sh文件(vim ./conf/spark-env.sh)，在第一行添加以下配置信息:</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>export SPARK_DIST_CLASSPATH=$(/usr/local/hadoop/hadoop-2.8.5/bin/hadoop classpath)</div></div><div><span style="font-weight: bold;">有了上面的配置信息以后，Spark就可以把数据存储到Hadoop分布式文件系统HDFS中，也可以从HDFS中读取数据。如果没有配置上面信息，Spark就只能读写本地数据，无法读写HDFS数据。</span></div><div><br/></div><ul><ul><li><div><a href="https://subscription.packtpub.com/book/big-data-and-business-intelligence/9781787127265/1/ch01lvl1sec16/deploying-spark-on-a-cluster-with-yarn" style="font-weight: bold;">https://subscription.packtpub.com/book/big-data-and-business-intelligence/9781787127265/1/ch01lvl1sec16/deploying-spark-on-a-cluster-with-yarn</a></div></li></ul></ul><div><span style="font-weight: bold;">Deploying Spark on a cluster with YARN,to run Spark on YARN, the first step is to set the configuration</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>HADOOP_CONF_DIR: to write to HDFS</div><div>YARN_CONF_DIR: to connect to YARN ResourceManager</div><div>$ cd /opt/infoobjects/spark/conf (or /etc/spark)</div><div>$ sudo vi spark-env.sh</div><div>export HADOOP_CONF_DIR=/opt/infoobjects/hadoop/etc/Hadoop</div><div>export YARN_CONF_DIR=/opt/infoobjects/hadoop/etc/hadoop</div></div><div><br/><br/><span>    </span>23. Start Spark</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>$SPARK_HOME/sbin/start-all.sh</div></div><div><br/><span>    24. Start spark cli</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>$ spark-shell</div></div><div><br/><b><font style="font-size: 24px; background-color: rgb(255, 250, 165);-evernote-highlight:true;">Encounter WARN issue</font></b><br/></div><div><font style="font-size: 24px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#ff2600" style="">22/05/02 16:48:04 WARN util.Utils: Your hostname, tony-ubuntu resolves to a loopback address: 127.0.1.1; using 10.0.2.15 instead (on interface enp0s3)</font></div><div><font color="#ff2600" style="">22/05/02 16:48:04 WARN util.Utils: Set SPARK_LOCAL_IP if you need to bind to another address</font></div></div></font><br/></div><div><br/></div><div><img src="Apache%20Spark%20Configuration.resources/D59621D1-DFA1-4C9A-98F3-6B2EEF273602.png" height="656" width="2356"/><br/></div><div><br/></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#ff2600">22/05/02 17:07:04 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</font></div></div></span></div><div><br/></div><div><font style="font-size: 18px;" color="#009051">Solution: </font></div><div><font style="font-size: 18px;">Setting below environments in spark-env.sh (/usr/local/spark/spark-2.4.4/conf/spark-env/sh):</font></div><div><img src="Apache%20Spark%20Configuration.resources/CE4CE2A7-6EA2-40BA-A429-689744D40465.png" height="300" width="902"/></div><div><span style="font-family: NeuePlakText-Regular; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font color="#008f00">export LD_LIBRARY_PATH=$HADOOP_HOME/lib/native</font></span><br/></div><div><span style="color: rgb(51, 51, 51); font-family: NeuePlakText-Regular; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="color: rgb(51, 51, 51); font-family: NeuePlakText-Regular; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div><span style="color: rgb(51, 51, 51); font-family: NeuePlakText-Regular; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font color="#ff2600">[ERROR] Failed to construct terminal; falling back to unsupported</font></div><div><font color="#ff2600">java.lang.NumberFormatException: For input string: "0x100"</font></div></div><div><font color="#009051" style="font-size: 24px;">solution:</font></div><div><font style="font-size: 24px;">Add "<font color="#009051">export TERM=xterm-color</font>” to ~/.bashrc</font></div><hr/><div><br/></div></body></html>